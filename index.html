<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€å‘¨ç¾å‘³è¥å…»èœè°±è®¾è®¡å·¥å…·</title>
    <style>
        /* ä¹‹å‰çš„æ ·å¼ä¿æŒä¸å˜ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #fff9f0;
            padding: 15px;
            color: #333;
            background-image: linear-gradient(120deg, #fff9f0 0%, #ffe8e8 100%);
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #ff6b6b;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-shadow: 2px 2px 0px #ffd166;
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 8px 15px rgba(255,107,107,0.2);
            border: 3px dashed #ffd166;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .dishes-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .dishes-section {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            border: 2px solid;
        }
        
        #meatDishesContainer {
            border-color: #ff9aa2;
        }
        
        #vegetableDishesContainer {
            border-color: #b5e48c;
        }
        
        #soupDishesContainer {
            border-color: #a2d2ff;
        }
        
        .dishes-section h2 {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 3px dotted;
            color: #2c3e50;
            font-size: 1.5rem;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.1);
        }
        
        #meatDishesContainer h2 {
            color: #ff6b6b;
            border-color: #ff9aa2;
        }
        
        #vegetableDishesContainer h2 {
            color: #06d6a0;
            border-color: #b5e48c;
        }
        
        #soupDishesContainer h2 {
            color: #118ab2;
            border-color: #a2d2ff;
        }
        
        .dishes-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            min-height: 150px;
        }
        
        .dish-item {
            width: 120px;
            height: 70px;
            border: 2px dashed;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            cursor: grab;
            transition: all 0.3s;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            position: relative;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            touch-action: manipulation;
        }
        
        .meat-dish {
            background-color: #ffebee;
            border-color: #ff9aa2;
            color: #d32f2f;
            box-shadow: 0 4px 8px rgba(255,154,162,0.3);
        }
        
        .vegetable-dish {
            background-color: #f1f8e9;
            border-color: #b5e48c;
            color: #388e3c;
            box-shadow: 0 4px 8px rgba(181,228,140,0.3);
        }
        
        .soup-dish {
            background-color: #e3f2fd;
            border-color: #a2d2ff;
            color: #1565c0;
            box-shadow: 0 4px 8px rgba(162,210,255,0.3);
        }
        
        .dish-item:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        
        .dish-item.dragging {
            opacity: 0.7;
            transform: rotate(5deg);
        }
        
        .dish-item::before {
            content: "";
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.3) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.5s;
        }
        
        .dish-item:hover::before {
            transform: translateX(100%);
        }
        
        .menu-table {
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
            border: 3px solid #ffd166;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            border: 2px solid #ffd166;
            padding: 10px;
            text-align: center;
            vertical-align: middle;
        }
        
        th {
            background-color: #ff6b6b;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.2);
        }
        
        td {
            height: 100px;
            background-color: #fff9f0;
            transition: background-color 0.3s;
            cursor: pointer;
            position: relative;
        }
        
        td.drop-zone {
            background-color: #fff9f0;
        }
        
        td.drop-zone.highlight {
            background-color: #ffebee;
        }
        
        .cell-content {
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border-radius: 12px;
            padding: 8px;
            transition: all 0.3s;
            touch-action: manipulation;
            font-size: 14px;
        }
        
        .cell-meat {
            background-color: #ffebee;
            color: #d32f2f;
            border: 2px dashed #ff9aa2;
        }
        
        .cell-vegetable {
            background-color: #f1f8e9;
            color: #388e3c;
            border: 2px dashed #b5e48c;
        }
        
        .cell-soup {
            background-color: #e3f2fd;
            color: #1565c0;
            border: 2px dashed #a2d2ff;
        }
        
        .cell-content:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }
        
        button::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        #saveBtn {
            background-color: #06d6a0;
            color: white;
        }
        
        #saveBtn:hover {
            background-color: #04b586;
            transform: translateY(-3px);
        }
        
        #resetBtn {
            background-color: #ff9e00;
            color: white;
        }
        
        #resetBtn:hover {
            background-color: #e68a00;
            transform: translateY(-3px);
        }
        
        .message {
            text-align: center;
            margin-top: 15px;
            padding: 12px;
            border-radius: 15px;
            font-weight: bold;
            display: none;
            font-size: 16px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        .empty-cell {
            color: #aaa;
            font-style: italic;
        }
        
        /* é€‰æ‹©æ¨¡æ€æ¡†æ ·å¼ - åœ¨iPadå’ŒWebç«¯éšè— */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ffd166;
        }
        
        .modal-title {
            color: #ff6b6b;
            font-size: 1.5rem;
        }
        
        .close-modal {
            font-size: 1.8rem;
            cursor: pointer;
            color: #aaa;
            transition: color 0.3s;
        }
        
        .close-modal:hover {
            color: #ff6b6b;
        }
        
        .modal-dishes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }
        
        .modal-dish {
            flex: 1 0 calc(50% - 10px);
            min-width: calc(50% - 10px);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .modal-meat {
            background-color: #ffebee;
            color: #d32f2f;
            border: 2px dashed #ff9aa2;
        }
        
        .modal-vegetable {
            background-color: #f1f8e9;
            color: #388e3c;
            border: 2px dashed #b5e48c;
        }
        
        .modal-soup {
            background-color: #e3f2fd;
            color: #1565c0;
            border: 2px dashed #a2d2ff;
        }
        
        .modal-dish.selected {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .modal-cancel {
            background-color: #f0f0f0;
            color: #333;
        }
        
        .modal-confirm {
            background-color: #06d6a0;
            color: white;
        }
        
        /* æ–°å¢æ ·å¼ï¼šæ‹–æ‹½æ—¶çš„è§†è§‰åé¦ˆ */
        .drag-over {
            background-color: #e0f7fa !important;
            transform: scale(1.02);
            transition: all 0.2s;
        }
        
        .dragging-element {
            position: fixed;
            z-index: 10000;
            pointer-events: none;
            transform: rotate(5deg) scale(1.1);
            opacity: 0.9;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        
        /* æ–°å¢æ ·å¼ï¼šiPadæ‹–æ‹½ä¼˜åŒ– */
        .no-scroll {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
        }
        
        /* ç§»åŠ¨ç«¯æ ·å¼ - åªåœ¨çœŸæ­£çš„æ‰‹æœºè®¾å¤‡ä¸Šåº”ç”¨ */
        @media (max-width: 768px) and (hover: none) and (pointer: coarse) {
            .dishes-row {
                display: none; /* åªåœ¨çœŸæ­£çš„ç§»åŠ¨ç«¯éšè—èœå“åˆ—è¡¨ */
            }
            
            .dishes-section {
                min-width: 100%;
            }
            
            h1 {
                font-size: 1.6rem;
                padding: 12px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 300px;
            }
            
            .dish-item {
                width: 100px;
                height: 70px;
                font-size: 14px;
            }
            
            th, td {
                padding: 8px;
            }
            
            td {
                height: 90px;
            }
            
            /* ç§»åŠ¨ç«¯å•å…ƒæ ¼æ ·å¼è°ƒæ•´ */
            .cell-content {
                min-height: 70px;
                font-size: 14px;
            }
        }
        
        @media (max-width: 480px) and (hover: none) and (pointer: coarse) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.4rem;
                padding: 10px;
            }
            
            .dishes-section {
                padding: 12px;
            }
            
            .dish-item {
                width: 80px;
                height: 60px;
                font-size: 12px;
            }
            
            .cell-content {
                font-size: 12px;
                padding: 5px;
            }
            
            .modal-dish {
                flex: 1 0 100%;
                min-width: 100%;
            }
        }
        
        /* iPadç‰¹å®šæ ·å¼ - ç¡®ä¿æ˜¾ç¤ºèœå“åŒºåŸŸå¹¶ä½¿ç”¨æ‹–æ‹½æ¨¡å¼ */
        @media (min-width: 769px) and (max-width: 1024px) {
            /* æ•´ä½“å¸ƒå±€è°ƒæ•´ - æ›´ç´§å‡‘çš„å¸ƒå±€ */
            body {
                padding: 10px;
                overflow-x: hidden;
            }
            
            .container {
                max-width: 100%;
            }
            
            h1 {
                font-size: 1.6rem;
                margin-bottom: 15px;
                padding: 12px;
            }
            
            .game-area {
                gap: 12px;
                margin-bottom: 15px;
            }
            
            .dishes-row {
                display: flex; /* ç¡®ä¿åœ¨iPadä¸Šæ˜¾ç¤ºèœå“åŒºåŸŸ */
                gap: 12px;
                margin-bottom: 12px;
            }
            
            .dishes-section {
                min-width: calc(33.333% - 8px);
                padding: 12px;
            }
            
            .dishes-section h2 {
                font-size: 1.2rem;
                margin-bottom: 12px;
            }
            
            .dishes-container {
                gap: 8px;
                min-height: 130px;
            }
            
            .dish-item {
                width: 100px;
                height: 65px;
                font-size: 12px;
                border-radius: 12px;
            }
            
            .menu-table {
                padding: 12px;
            }
            
            th, td {
                padding: 8px;
            }
            
            th {
                font-size: 0.9rem;
            }
            
            td {
                height: 85px;
            }
            
            .cell-content {
                min-height: 70px;
                font-size: 12px;
                padding: 6px;
            }
            
            .controls {
                margin-top: 12px;
            }
            
            button {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            /* åœ¨iPadä¸Šéšè—æ¨¡æ€æ¡† */
            .modal {
                display: none !important;
            }
            
            /* é˜²æ­¢æ‹–æ‹½æ—¶é¡µé¢æ»šåŠ¨ */
            body.dragging-active {
                overflow: hidden;
                position: fixed;
                width: 100%;
                height: 100%;
            }
        }
        
        /* Webç«¯æ ·å¼ - éšè—æ¨¡æ€æ¡† */
        @media (min-width: 1025px) {
            .modal {
                display: none !important;
            }
        }
        
        /* é’ˆå¯¹å¹³æ¿ç«–å±æ¨¡å¼çš„ç‰¹æ®Šè°ƒæ•´ */
        @media (max-height: 1024px) and (min-width: 769px) {
            body {
                padding: 8px;
            }
            
            h1 {
                font-size: 1.5rem;
                margin-bottom: 10px;
                padding: 10px;
            }
            
            .dishes-row {
                gap: 10px;
                margin-bottom: 10px;
            }
            
            .dishes-section {
                padding: 10px;
            }
            
            .dishes-container {
                min-height: 120px;
            }
            
            .dish-item {
                width: 95px;
                height: 60px;
                font-size: 11px;
            }
            
            .menu-table {
                padding: 10px;
            }
            
            td {
                height: 80px;
            }
            
            .cell-content {
                min-height: 65px;
                font-size: 11px;
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ½ï¸ è®¾è®¡ä¸€å‘¨ç¾å‘³åˆè¥å…»çš„èœè°± ğŸ½ï¸</h1>
        
        <div class="game-area">
            <div class="dishes-row">
                <div class="dishes-section" id="meatDishesContainer">
                    <h2>ğŸ¥© è¤èœ ğŸ¥©</h2>
                    <div class="dishes-container" id="meatDishes">
                        <!-- è¤èœå°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
                
                <div class="dishes-section" id="vegetableDishesContainer">
                    <h2>ğŸ¥¦ ç´ èœ ğŸ¥¦</h2>
                    <div class="dishes-container" id="vegetableDishes">
                        <!-- ç´ èœå°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
                
                <div class="dishes-section" id="soupDishesContainer">
                    <h2>ğŸ² æ±¤å“ ğŸ²</h2>
                    <div class="dishes-container" id="soupDishes">
                        <!-- æ±¤å“å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </div>
            
            <div class="menu-table">
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>å‘¨ä¸€</th>
                            <th>å‘¨äºŒ</th>
                            <th>å‘¨ä¸‰</th>
                            <th>å‘¨å››</th>
                            <th>å‘¨äº”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>è¤èœ</th>
                            <td class="drop-zone" data-day="mon" data-type="meat"></td>
                            <td class="drop-zone" data-day="tue" data-type="meat"></td>
                            <td class="drop-zone" data-day="wed" data-type="meat"></td>
                            <td class="drop-zone" data-day="thu" data-type="meat"></td>
                            <td class="drop-zone" data-day="fri" data-type="meat"></td>
                        </tr>
                        <tr>
                            <th>ç´ èœ</th>
                            <td class="drop-zone" data-day="mon" data-type="vegetable"></td>
                            <td class="drop-zone" data-day="tue" data-type="vegetable"></td>
                            <td class="drop-zone" data-day="wed" data-type="vegetable"></td>
                            <td class="drop-zone" data-day="thu" data-type="vegetable"></td>
                            <td class="drop-zone" data-day="fri" data-type="vegetable"></td>
                        </tr>
                        <tr>
                            <th>æ±¤å“</th>
                            <td class="drop-zone" data-day="mon" data-type="soup"></td>
                            <td class="drop-zone" data-day="tue" data-type="soup"></td>
                            <td class="drop-zone" data-day="wed" data-type="soup"></td>
                            <td class="drop-zone" data-day="thu" data-type="soup"></td>
                            <td class="drop-zone" data-day="fri" data-type="soup"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="controls">
            <button id="saveBtn">ğŸ’¾ ä¿å­˜èœè°±</button>
            <button id="resetBtn">ğŸ”„ é‡ç½®èœè°±</button>
        </div>
        
        <div class="message" id="message"></div>
    </div>

    <!-- èœå“é€‰æ‹©æ¨¡æ€æ¡† - åªåœ¨æ‰‹æœºç«¯æ˜¾ç¤º -->
    <div class="modal" id="dishSelectionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">é€‰æ‹©èœå“</h3>
                <span class="close-modal" id="closeModal">&times;</span>
            </div>
            <div class="modal-dishes" id="modalDishesList">
                <!-- èœå“å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-cancel" id="cancelSelection">å–æ¶ˆ</button>
                <button class="modal-btn modal-confirm" id="confirmSelection">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <script>
        // èœå“æ•°æ®
        const dishes = {
            meat: [
                "ç•ªèŒ„ç‚’è›‹", "äº”å½©ç‰›è‚‰ä¸", "è‚‰é¥¼è’¸è›‹", "ç‚¸è™¾é¥¼", "çº¢çƒ§ç¿…æ ¹",
                "ç³–é†‹æ’éª¨", "é¸¡è…¿", "æ´‹è‘±ç‰›ä»”éª¨", "é‡‘æ±¤å·´æ²™é±¼ç‰‡", "è™¾ä»æºœè›‹"
            ],
            vegetable: [
                "èƒ¡èåœèŠ±èœ", "è±†è…ç¾¹", "é»‘æœ¨è€³ç‚’åŒ…èœ", "é¦™è‡å¤§ç™½èœ", "æœ¨è€³è¥¿è“èŠ±",
                "æ¸…ç‚’åœŸè±†", "ç‚’ç²‰ä¸", "åœ°ä¸‰é²œ", "ç³–é†‹è—•ç‰‡", "æ²¹è±†è…å¤§ç™½èœ"
            ],
            soup: [
                "çº¢è±†åœ†å­æ±¤", "ç´ èœæ±¤", "ä»€é”¦ç³Šæ±¤", "é‡‘é’ˆè‡ç•ªèŒ„è›‹æ±¤", "ç•ªèŒ„ç¬‹å¹²è›‹æ±¤",
                "ç‰›è‚‰ç²‰ä¸æ±¤", "ç­’éª¨å†¬ç“œæ±¤", "ç»¿è±†ç™¾åˆæ±¤", "ç½—å®‹æ±¤", "æ»‹è¡¥é¸¡æ±¤"
            ]
        };

        // å­˜å‚¨å½“å‰æ”¾ç½®çš„èœå“ä¿¡æ¯
        const placedDishes = {
            meat: {},
            vegetable: {},
            soup: {}
        };

        // ç§»åŠ¨ç«¯é€‰æ‹©ç›¸å…³å˜é‡
        let currentCell = null;
        let selectedDish = null;

        // æ‹–æ‹½ç›¸å…³å˜é‡
        let dragElement = null;
        let dragClone = null;
        let dragOffset = { x: 0, y: 0 };
        let isDragging = false;
        let lastTouch = null;
        let startScrollY = 0;
        let touchStartX = 0;
        let touchStartY = 0;
        let touchStartTime = 0;

        // åˆå§‹åŒ–èœå“
        function initializeDishes() {
            // åˆå§‹åŒ–è¤èœ
            const meatContainer = document.getElementById('meatDishes');
            dishes.meat.forEach(dish => {
                const dishElement = createDishElement(dish, 'meat');
                meatContainer.appendChild(dishElement);
            });

            // åˆå§‹åŒ–ç´ èœ
            const vegetableContainer = document.getElementById('vegetableDishes');
            dishes.vegetable.forEach(dish => {
                const dishElement = createDishElement(dish, 'vegetable');
                vegetableContainer.appendChild(dishElement);
            });

            // åˆå§‹åŒ–æ±¤å“
            const soupContainer = document.getElementById('soupDishes');
            dishes.soup.forEach(dish => {
                const dishElement = createDishElement(dish, 'soup');
                soupContainer.appendChild(dishElement);
            });
        }

        // åˆ›å»ºèœå“å…ƒç´ 
        function createDishElement(dishName, type) {
            const dishElement = document.createElement('div');
            dishElement.className = `dish-item ${type}-dish`;
            dishElement.draggable = true;
            dishElement.dataset.name = dishName;
            dishElement.dataset.type = type;
            
            dishElement.textContent = dishName;
            
            // æ·»åŠ æ‹–æ‹½äº‹ä»¶
            dishElement.addEventListener('dragstart', handleDragStart);
            dishElement.addEventListener('dragend', handleDragEnd);
            
            // æ·»åŠ è§¦æ‘¸äº‹ä»¶æ”¯æŒ - ç”¨äºiPadä¸Šçš„æ‹–æ‹½
            dishElement.addEventListener('touchstart', handleTouchStart, {passive: false});
            dishElement.addEventListener('touchmove', handleTouchMove, {passive: false});
            dishElement.addEventListener('touchend', handleTouchEnd);
            
            // åªåœ¨æ‰‹æœºç«¯æ·»åŠ ç‚¹å‡»äº‹ä»¶
            if (isMobileDevice() && !isIPadDevice()) {
                dishElement.addEventListener('click', handleDishClick);
            }
            
            return dishElement;
        }

        // åˆ›å»ºå•å…ƒæ ¼å†…å®¹
        function createCellContent(dishName, type) {
            const cellContent = document.createElement('div');
            cellContent.className = `cell-content cell-${type}`;
            cellContent.draggable = true;
            cellContent.dataset.name = dishName;
            cellContent.dataset.type = type;
            
            cellContent.textContent = dishName;
            
            // æ·»åŠ æ‹–æ‹½äº‹ä»¶
            cellContent.addEventListener('dragstart', handleCellDragStart);
            cellContent.addEventListener('dragend', handleCellDragEnd);
            
            // æ·»åŠ è§¦æ‘¸äº‹ä»¶æ”¯æŒ - ç”¨äºiPadä¸Šçš„æ‹–æ‹½
            cellContent.addEventListener('touchstart', handleTouchStart, {passive: false});
            cellContent.addEventListener('touchmove', handleTouchMove, {passive: false});
            cellContent.addEventListener('touchend', handleTouchEnd);
            
            return cellContent;
        }

        // è§¦æ‘¸å¼€å§‹äº‹ä»¶ - ä¼˜åŒ–iPadæ‹–æ‹½
        function handleTouchStart(e) {
            // åªæœ‰åœ¨iPadä¸Šæ‰å¤„ç†è§¦æ‘¸æ‹–æ‹½
            if (!isIPadDevice()) return;
            
            e.preventDefault();
            const touch = e.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
            touchStartTime = Date.now();
            dragElement = this;
            
            // è®°å½•è§¦æ‘¸ä½ç½®ç›¸å¯¹äºå…ƒç´ å·¦ä¸Šè§’çš„åç§»
            const rect = this.getBoundingClientRect();
            dragOffset.x = touch.clientX - rect.left;
            dragOffset.y = touch.clientY - rect.top;
            
            // è®°å½•åˆå§‹æ»šåŠ¨ä½ç½®
            startScrollY = window.scrollY;
            
            // åˆ›å»ºæ‹–æ‹½å…ƒç´ çš„å…‹éš†
            dragClone = this.cloneNode(true);
            dragClone.classList.add('dragging-element');
            dragClone.style.width = `${rect.width}px`;
            dragClone.style.height = `${rect.height}px`;
            dragClone.style.left = `${touch.clientX - dragOffset.x}px`;
            dragClone.style.top = `${touch.clientY - dragOffset.y + startScrollY}px`;
            document.body.appendChild(dragClone);
            
            // æ·»åŠ æ‹–æ‹½æ ·å¼
            this.classList.add('dragging');
            
            // å­˜å‚¨æ‹–æ‹½æ•°æ®
            const data = {
                name: this.dataset.name,
                type: this.dataset.type,
                source: this.classList.contains('cell-content') ? 'cell' : 'dish-area'
            };
            
            this._dragData = data;
            isDragging = false; // åˆå§‹çŠ¶æ€ä¸ºæœªæ‹–æ‹½
            
            // é˜»æ­¢é¡µé¢æ»šåŠ¨
            document.body.classList.add('no-scroll');
            document.body.classList.add('dragging-active');
        }

        // è§¦æ‘¸ç§»åŠ¨äº‹ä»¶ - ä¼˜åŒ–iPadæ‹–æ‹½
        function handleTouchMove(e) {
            // åªæœ‰åœ¨iPadä¸Šæ‰å¤„ç†è§¦æ‘¸æ‹–æ‹½
            if (!isIPadDevice() || !dragElement || !dragClone) return;
            
            e.preventDefault();
            const touch = e.touches[0];
            const deltaX = Math.abs(touch.clientX - touchStartX);
            const deltaY = Math.abs(touch.clientY - touchStartY);
            
            // å¦‚æœç§»åŠ¨è·ç¦»è¶³å¤Ÿå¤§ï¼Œåˆ™è®¤ä¸ºæ˜¯æ‹–æ‹½æ“ä½œ
            if (!isDragging && (deltaX > 10 || deltaY > 10)) {
                isDragging = true;
                
                // éšè—åŸå§‹å…ƒç´ 
                dragElement.style.opacity = '0.3';
            }
            
            if (isDragging) {
                // æ›´æ–°å…‹éš†å…ƒç´ ä½ç½®
                dragClone.style.left = `${touch.clientX - dragOffset.x}px`;
                dragClone.style.top = `${touch.clientY - dragOffset.y + window.scrollY}px`;
                
                // æ£€æŸ¥æ˜¯å¦ç»è¿‡å¯æ”¾ç½®åŒºåŸŸ
                const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY);
                const dropZone = findDropZone(dropTarget);
                
                // ç§»é™¤æ‰€æœ‰é«˜äº®
                document.querySelectorAll('.drop-zone.highlight').forEach(zone => {
                    zone.classList.remove('highlight');
                });
                
                // é«˜äº®å¯æ”¾ç½®åŒºåŸŸ
                if (dropZone) {
                    dropZone.classList.add('highlight');
                }
            }
            
            lastTouch = touch;
        }

        // è§¦æ‘¸ç»“æŸäº‹ä»¶ - ä¼˜åŒ–iPadæ‹–æ‹½
        function handleTouchEnd(e) {
            // åªæœ‰åœ¨iPadä¸Šæ‰å¤„ç†è§¦æ‘¸æ‹–æ‹½
            if (!isIPadDevice() || !dragElement) return;
            
            e.preventDefault();
            
            // æ¢å¤é¡µé¢æ»šåŠ¨
            document.body.classList.remove('no-scroll');
            document.body.classList.remove('dragging-active');
            
            // ç§»é™¤é«˜äº®
            document.querySelectorAll('.drop-zone.highlight').forEach(zone => {
                zone.classList.remove('highlight');
            });
            
            if (isDragging) {
                // æ¢å¤åŸå§‹å…ƒç´ 
                dragElement.style.opacity = '';
                dragElement.classList.remove('dragging');
                
                // ç§»é™¤å…‹éš†å…ƒç´ 
                if (dragClone) {
                    document.body.removeChild(dragClone);
                    dragClone = null;
                }
                
                // æŸ¥æ‰¾æ”¾ç½®åŒºåŸŸ
                if (lastTouch) {
                    const dropTarget = document.elementFromPoint(lastTouch.clientX, lastTouch.clientY);
                    const dropZone = findDropZone(dropTarget);
                    
                    if (dropZone && dragElement._dragData) {
                        // æ‰§è¡Œæ”¾ç½®æ“ä½œ
                        simulateDrop(dragElement._dragData, dropZone);
                    }
                }
                
                isDragging = false;
            } else {
                // å¦‚æœæ˜¯ç‚¹å‡»è€Œéæ‹–æ‹½
                const touch = e.changedTouches[0];
                const timeDiff = Date.now() - touchStartTime;
                const deltaX = Math.abs(touch.clientX - touchStartX);
                const deltaY = Math.abs(touch.clientY - touchStartY);
                
                // å¦‚æœæ˜¯çŸ­æ—¶é—´å°è·ç¦»çš„è§¦æ‘¸ï¼Œè§†ä¸ºç‚¹å‡»
                if (timeDiff < 300 && deltaX < 5 && deltaY < 5) {
                    // ç§»é™¤å…‹éš†å…ƒç´ 
                    if (dragClone) {
                        document.body.removeChild(dragClone);
                        dragClone = null;
                    }
                    
                    dragElement.classList.remove('dragging');
                }
            }
            
            dragElement = null;
            lastTouch = null;
        }

        // æŸ¥æ‰¾æ”¾ç½®åŒºåŸŸ
        function findDropZone(element) {
            while (element && element !== document.body) {
                if (element.classList && element.classList.contains('drop-zone')) {
                    return element;
                }
                element = element.parentElement;
            }
            return null;
        }

        // æ¨¡æ‹Ÿæ”¾ç½®æ“ä½œ
        function simulateDrop(data, dropZone) {
            const dishType = data.type;
            const cellType = dropZone.dataset.type;
            const day = dropZone.dataset.day;
            
            // æ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…
            if (dishType !== cellType) {
                showMessage('èœå“ç±»å‹ä¸åŒ¹é…ï¼è¯·å°†èœå“æ‹–åˆ°å¯¹åº”çš„è¡Œä¸­ã€‚', false);
                return;
            }
            
            // å¦‚æœæ˜¯ä»å•å…ƒæ ¼æ‹–æ‹½ï¼Œå…ˆç§»é™¤åŸå•å…ƒæ ¼çš„å†…å®¹
            if (data.source === 'cell') {
                // æ‰¾åˆ°åŸå•å…ƒæ ¼å¹¶æ¸…ç©º
                const originalCell = document.querySelector(`.cell-content[data-name="${data.name}"]`).closest('.drop-zone');
                if (originalCell) {
                    originalCell.innerHTML = '';
                    originalCell.classList.remove('has-dish');
                    
                    // ä»å·²æ”¾ç½®èœå“ä¸­ç§»é™¤
                    delete placedDishes[dishType][data.name];
                }
            }
            
            // å¦‚æœç›®æ ‡å•å…ƒæ ¼å·²æœ‰èœå“ï¼Œå°†å…¶æ”¾å›èœå“åŒºåŸŸ
            if (dropZone.querySelector('.cell-content')) {
                const existingDish = dropZone.querySelector('.cell-content').textContent;
                returnDishToArea(existingDish, dishType);
            }
            
            // æ¸…ç©ºå•å…ƒæ ¼å†…å®¹
            dropZone.innerHTML = '';
            
            // åˆ›å»ºå•å…ƒæ ¼å†…å®¹
            const cellContent = createCellContent(data.name, dishType);
            
            dropZone.appendChild(cellContent);
            dropZone.classList.add('has-dish');
            
            // è®°å½•å·²æ”¾ç½®çš„èœå“
            placedDishes[dishType][data.name] = day;
            
            showMessage(`æˆåŠŸ${data.source === 'cell' ? 'ç§»åŠ¨' : 'æ·»åŠ '} ${data.name} åˆ°èœè°±ï¼`, true);
        }

        // æ‹–æ‹½å¼€å§‹ï¼ˆä»èœå“åŒºåŸŸï¼‰
        function handleDragStart(e) {
            // åœ¨æ‰‹æœºç«¯ï¼ˆéiPadï¼‰é˜»æ­¢æ‹–æ‹½
            if (isMobileDevice() && !isIPadDevice()) {
                e.preventDefault();
                return;
            }
            
            this.classList.add('dragging');
            e.dataTransfer.setData('text/plain', JSON.stringify({
                name: this.dataset.name,
                type: this.dataset.type,
                source: 'dish-area'
            }));
        }

        // æ‹–æ‹½ç»“æŸï¼ˆä»èœå“åŒºåŸŸï¼‰
        function handleDragEnd() {
            this.classList.remove('dragging');
        }

        // æ‹–æ‹½å¼€å§‹ï¼ˆä»å•å…ƒæ ¼ï¼‰
        function handleCellDragStart(e) {
            // åœ¨æ‰‹æœºç«¯ï¼ˆéiPadï¼‰é˜»æ­¢æ‹–æ‹½
            if (isMobileDevice() && !isIPadDevice()) {
                e.preventDefault();
                return;
            }
            
            this.classList.add('dragging');
            e.dataTransfer.setData('text/plain', JSON.stringify({
                name: this.dataset.name,
                type: this.dataset.type,
                source: 'cell'
            }));
        }

        // æ‹–æ‹½ç»“æŸï¼ˆä»å•å…ƒæ ¼ï¼‰
        function handleCellDragEnd() {
            this.classList.remove('dragging');
        }

        // èœå“ç‚¹å‡»äº‹ä»¶ï¼ˆæ‰‹æœºç«¯ï¼‰
        function handleDishClick() {
            // åªåœ¨æ‰‹æœºç«¯å¤„ç†ç‚¹å‡»äº‹ä»¶
            if (!isMobileDevice() || isIPadDevice()) {
                return;
            }
            
            // åœ¨æ‰‹æœºç«¯ï¼Œç‚¹å‡»èœå“ä¸åšä»»ä½•æ“ä½œï¼Œå› ä¸ºæ‰‹æœºç«¯æ˜¯é€šè¿‡ç‚¹å‡»è¡¨æ ¼å•å…ƒæ ¼æ¥é€‰æ‹©èœå“çš„
        }

        // åˆå§‹åŒ–è¡¨æ ¼å•å…ƒæ ¼çš„æ‹–æ”¾äº‹ä»¶
        function initializeTableCells() {
            const dropZones = document.querySelectorAll('.drop-zone');
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragenter', handleDragEnter);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
                
                // æ·»åŠ è§¦æ‘¸äº‹ä»¶æ”¯æŒ - ç”¨äºiPadä¸Šçš„æ‹–æ‹½
                zone.addEventListener('touchmove', handleTouchMoveOver, {passive: false});
                zone.addEventListener('touchend', handleTouchDrop);
                
                // åªåœ¨æ‰‹æœºç«¯æ·»åŠ ç‚¹å‡»äº‹ä»¶
                if (isMobileDevice() && !isIPadDevice()) {
                    zone.addEventListener('click', handleCellClick);
                }
            });
        }

        // è§¦æ‘¸æ‹–æ‹½ç»è¿‡äº‹ä»¶
        function handleTouchMoveOver(e) {
            // åªæœ‰åœ¨iPadä¸Šæ‰å¤„ç†è§¦æ‘¸æ‹–æ‹½
            if (!isIPadDevice() || !isDragging) return;
            
            e.preventDefault();
            this.classList.add('highlight');
        }

        // è§¦æ‘¸æ”¾ç½®äº‹ä»¶
        function handleTouchDrop(e) {
            // åªæœ‰åœ¨iPadä¸Šæ‰å¤„ç†è§¦æ‘¸æ‹–æ‹½
            if (!isIPadDevice()) return;
            
            e.preventDefault();
            this.classList.remove('highlight');
        }

        // å¤„ç†æ‹–æ‹½ç»è¿‡
        function handleDragOver(e) {
            // åœ¨æ‰‹æœºç«¯ï¼ˆéiPadï¼‰é˜»æ­¢æ‹–æ‹½
            if (isMobileDevice() && !isIPadDevice()) {
                e.preventDefault();
                return;
            }
            
            e.preventDefault();
        }

        // å¤„ç†æ‹–æ‹½è¿›å…¥
        function handleDragEnter(e) {
            // åœ¨æ‰‹æœºç«¯ï¼ˆéiPadï¼‰é˜»æ­¢æ‹–æ‹½
            if (isMobileDevice() && !isIPadDevice()) {
                e.preventDefault();
                return;
            }
            
            e.preventDefault();
            this.classList.add('highlight');
        }

        // å¤„ç†æ‹–æ‹½ç¦»å¼€
        function handleDragLeave() {
            // åœ¨æ‰‹æœºç«¯ï¼ˆéiPadï¼‰é˜»æ­¢æ‹–æ‹½
            if (isMobileDevice() && !isIPadDevice()) {
                return;
            }
            
            this.classList.remove('highlight');
        }

        // å¤„ç†æ”¾ç½®
        function handleDrop(e) {
            // åœ¨æ‰‹æœºç«¯ï¼ˆéiPadï¼‰é˜»æ­¢æ‹–æ‹½
            if (isMobileDevice() && !isIPadDevice()) {
                e.preventDefault();
                return;
            }
            
            e.preventDefault();
            this.classList.remove('highlight');
            
            const data = JSON.parse(e.dataTransfer.getData('text/plain'));
            const dishType = data.type;
            const cellType = this.dataset.type;
            const day = this.dataset.day;
            
            // æ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…
            if (dishType !== cellType) {
                showMessage('èœå“ç±»å‹ä¸åŒ¹é…ï¼è¯·å°†èœå“æ‹–åˆ°å¯¹åº”çš„è¡Œä¸­ã€‚', false);
                return;
            }
            
            // å¦‚æœæ˜¯ä»å•å…ƒæ ¼æ‹–æ‹½ï¼Œå…ˆç§»é™¤åŸå•å…ƒæ ¼çš„å†…å®¹
            if (data.source === 'cell') {
                // æ‰¾åˆ°åŸå•å…ƒæ ¼å¹¶æ¸…ç©º
                const originalCell = document.querySelector(`.cell-content[data-name="${data.name}"]`).closest('.drop-zone');
                if (originalCell) {
                    originalCell.innerHTML = '';
                    originalCell.classList.remove('has-dish');
                    
                    // ä»å·²æ”¾ç½®èœå“ä¸­ç§»é™¤
                    delete placedDishes[dishType][data.name];
                }
            }
            
            // å¦‚æœç›®æ ‡å•å…ƒæ ¼å·²æœ‰èœå“ï¼Œå°†å…¶æ”¾å›èœå“åŒºåŸŸ
            if (this.querySelector('.cell-content')) {
                const existingDish = this.querySelector('.cell-content').textContent;
                returnDishToArea(existingDish, dishType);
            }
            
            // æ¸…ç©ºå•å…ƒæ ¼å†…å®¹
            this.innerHTML = '';
            
            // åˆ›å»ºå•å…ƒæ ¼å†…å®¹
            const cellContent = createCellContent(data.name, dishType);
            
            this.appendChild(cellContent);
            this.classList.add('has-dish');
            
            // è®°å½•å·²æ”¾ç½®çš„èœå“
            placedDishes[dishType][data.name] = day;
            
            showMessage(`æˆåŠŸ${data.source === 'cell' ? 'ç§»åŠ¨' : 'æ·»åŠ '} ${data.name} åˆ°èœè°±ï¼`, true);
        }

        // å•å…ƒæ ¼ç‚¹å‡»äº‹ä»¶ï¼ˆæ‰‹æœºç«¯ï¼‰
        function handleCellClick() {
            // åªåœ¨æ‰‹æœºç«¯å¤„ç†ç‚¹å‡»äº‹ä»¶
            if (!isMobileDevice() || isIPadDevice()) {
                return;
            }
            
            // åœ¨æ‰‹æœºç«¯ï¼Œç‚¹å‡»å•å…ƒæ ¼å¼¹å‡ºé€‰æ‹©èœå•
            currentCell = this;
            const cellType = this.dataset.type;
            const day = this.dataset.day;
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            showDishSelectionModal(cellType, day);
        }
        

        // æ˜¾ç¤ºèœå“é€‰æ‹©æ¨¡æ€æ¡†
        function showDishSelectionModal(type, day) {
            // åªåœ¨æ‰‹æœºç«¯æ˜¾ç¤ºæ¨¡æ€æ¡†
            if (!isMobileDevice() || isIPadDevice()) {
                return;
            }
            
            const modal = document.getElementById('dishSelectionModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalDishesList = document.getElementById('modalDishesList');
            
            // è®¾ç½®æ¨¡æ€æ¡†æ ‡é¢˜
            const dayNames = {
                'mon': 'å‘¨ä¸€',
                'tue': 'å‘¨äºŒ',
                'wed': 'å‘¨ä¸‰',
                'thu': 'å‘¨å››',
                'fri': 'å‘¨äº”'
            };
            
            const typeNames = {
                'meat': 'è¤èœ',
                'vegetable': 'ç´ èœ',
                'soup': 'æ±¤å“'
            };
            
            modalTitle.textContent = `é€‰æ‹©${dayNames[day]}${typeNames[type]}`;
            
            // æ¸…ç©ºæ¨¡æ€æ¡†å†…å®¹
            modalDishesList.innerHTML = '';
            
            // æ·»åŠ èœå“é€‰é¡¹
            dishes[type].forEach(dish => {
                const dishElement = document.createElement('div');
                dishElement.className = `modal-dish modal-${type}`;
                dishElement.textContent = dish;
                dishElement.dataset.name = dish;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                dishElement.addEventListener('click', () => {
                    // ç§»é™¤ä¹‹å‰é€‰ä¸­çš„èœå“
                    const selected = modalDishesList.querySelector('.selected');
                    if (selected) {
                        selected.classList.remove('selected');
                    }
                    
                    // é€‰ä¸­å½“å‰èœå“
                    dishElement.classList.add('selected');
                    selectedDish = dish;
                });
                
                modalDishesList.appendChild(dishElement);
            });
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            modal.style.display = 'flex';
        }

        // éšè—èœå“é€‰æ‹©æ¨¡æ€æ¡†
        function hideDishSelectionModal() {
            const modal = document.getElementById('dishSelectionModal');
            modal.style.display = 'none';
            selectedDish = null;
        }

        // ç¡®è®¤é€‰æ‹©
        function confirmSelection() {
            if (!selectedDish || !currentCell) {
                showMessage('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªèœå“ï¼', false);
                return;
            }
            
            const cellType = currentCell.dataset.type;
            const day = currentCell.dataset.day;
            
            // å¦‚æœç›®æ ‡å•å…ƒæ ¼å·²æœ‰èœå“ï¼Œå°†å…¶æ”¾å›èœå“åŒºåŸŸ
            if (currentCell.querySelector('.cell-content')) {
                const existingDish = currentCell.querySelector('.cell-content').textContent;
                returnDishToArea(existingDish, cellType);
            }
            
            // æ¸…ç©ºå•å…ƒæ ¼å†…å®¹
            currentCell.innerHTML = '';
            
            // åˆ›å»ºå•å…ƒæ ¼å†…å®¹
            const cellContent = createCellContent(selectedDish, cellType);
            
            currentCell.appendChild(cellContent);
            currentCell.classList.add('has-dish');
            
            // è®°å½•å·²æ”¾ç½®çš„èœå“
            placedDishes[cellType][selectedDish] = day;
            
            showMessage(`æˆåŠŸæ·»åŠ  ${selectedDish} åˆ°èœè°±ï¼`, true);
            
            // éšè—æ¨¡æ€æ¡†
            hideDishSelectionModal();
        }

        // å°†èœå“æ”¾å›èœå“åŒºåŸŸ
        function returnDishToArea(dishName, type) {
            // ä»å·²æ”¾ç½®èœå“ä¸­ç§»é™¤
            delete placedDishes[type][dishName];
            
            // æ‰¾åˆ°å¯¹åº”çš„èœå“åŒºåŸŸ
            const dishArea = document.getElementById(`${type}Dishes`);
            
            // æ£€æŸ¥èœå“æ˜¯å¦å·²ç»åœ¨åŒºåŸŸä¸­
            const existingDish = dishArea.querySelector(`[data-name="${dishName}"]`);
            if (!existingDish) {
                // å¦‚æœä¸åœ¨åŒºåŸŸä¸­ï¼Œé‡æ–°åˆ›å»ºèœå“å…ƒç´ 
                const dishElement = createDishElement(dishName, type);
                dishArea.appendChild(dishElement);
            }
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, isSuccess) {
            const messageElement = document.getElementById('message');
            messageElement.textContent = message;
            messageElement.className = `message ${isSuccess ? 'success' : 'error'}`;
            messageElement.style.display = 'block';
            
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 3000);
        }

        // ä¿å­˜èœè°±
        function saveMenu() {
            const menuData = {};
            const days = ['mon', 'tue', 'wed', 'thu', 'fri'];
            const types = ['meat', 'vegetable', 'soup'];
            
            days.forEach(day => {
                menuData[day] = {};
                types.forEach(type => {
                    const cell = document.querySelector(`.drop-zone[data-day="${day}"][data-type="${type}"]`);
                    const dishName = cell.querySelector('.cell-content');
                    menuData[day][type] = dishName ? dishName.textContent : '';
                });
            });
            
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥å°†æ•°æ®å‘é€åˆ°æœåŠ¡å™¨æˆ–ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            // è¿™é‡Œåªæ˜¯ç®€å•åœ°åœ¨æ§åˆ¶å°è¾“å‡º
            console.log('èœè°±æ•°æ®:', menuData);
            showMessage('èœè°±ä¿å­˜æˆåŠŸï¼', true);
            
            // æ˜¾ç¤ºèœè°±æ‘˜è¦
            setTimeout(() => {
                alert('æ‚¨çš„èœè°±å·²ä¿å­˜ï¼æ‚¨å¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æŸ¥çœ‹å®Œæ•´æ•°æ®ã€‚');
            }, 500);
        }

        // é‡ç½®èœè°±
        function resetMenu() {
            const dropZones = document.querySelectorAll('.drop-zone');
            dropZones.forEach(zone => {
                zone.innerHTML = '';
                zone.classList.remove('has-dish');
            });
            
            // æ¸…ç©ºå·²æ”¾ç½®èœå“è®°å½•
            Object.keys(placedDishes).forEach(type => {
                placedDishes[type] = {};
            });
            
            // é‡æ–°åˆå§‹åŒ–èœå“åŒºåŸŸ
            document.getElementById('meatDishes').innerHTML = '';
            document.getElementById('vegetableDishes').innerHTML = '';
            document.getElementById('soupDishes').innerHTML = '';
            initializeDishes();
            
            showMessage('èœè°±å·²é‡ç½®ï¼', true);
        }

        // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
        function isMobileDevice() {
            return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
        }

        // æ£€æµ‹æ˜¯å¦ä¸ºiPadè®¾å¤‡
        function isIPadDevice() {
            return /iPad|Macintosh/i.test(navigator.userAgent) && 'ontouchend' in document;
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initializeDishes();
            initializeTableCells();
            
            // æ·»åŠ æŒ‰é’®äº‹ä»¶
            document.getElementById('saveBtn').addEventListener('click', saveMenu);
            document.getElementById('resetBtn').addEventListener('click', resetMenu);
            
            // æ·»åŠ æ¨¡æ€æ¡†äº‹ä»¶
            document.getElementById('closeModal').addEventListener('click', hideDishSelectionModal);
            document.getElementById('cancelSelection').addEventListener('click', hideDishSelectionModal);
            document.getElementById('confirmSelection').addEventListener('click', confirmSelection);
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            document.getElementById('dishSelectionModal').addEventListener('click', (e) => {
                if (e.target.id === 'dishSelectionModal') {
                    hideDishSelectionModal();
                }
            });
        });
    </script>
</body>
</html>